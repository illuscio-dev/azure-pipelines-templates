parameters:
  # What the primary language of this build is. Choices are GO | PYTHON | DOCKER.
  - name: language
    type: string

  # What the repo type for this build. Choices are LIBRARY | SERVICE. Service will
  # result in docker container build and push.
  - name: buildType
    type: string

  # Artifact feed to pull custom packages from (pass blank if not using).
  - name: pypiAzureArtifactFeed
    type: string

  # Publish to the public pypi.org
  - name: publishToPypiOrg
    type: boolean

  # Whether to build and publish a docker container.
  - name: publishContainer
    type: boolean

steps:

  # Publish libraries
  - ${{ if eq( '${{parameters.buildType}}', 'LIBRARY') }}:

    - template: publish_library.yml
      parameters:
        language: ${{ parameters.language }}
        pypiAzureArtifactFeed: ${{ parameters.pypiAzureArtifactFeed }}
        publishToPypiOrg: ${{ parameters.publishToPypiOrg }}

  - ${{ if eq( '${{parameters.buildType}}', 'SERIVCE')}}:

      - template: publish_service.yml
        parameters:
          language: ${{ parameters.language }}
